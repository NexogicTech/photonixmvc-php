# 路由配置

本文介绍在 Photonix 中如何配置路由、参数说明、示例与常见问题。

## 基本概念

- 路由注册集中位于 `app/routes/app.php`。
- 每条路由由 3 个要素构成：
  - `url`：路径（支持静态与参数化，如 `/user/{id}`）。
  - `controller`：调用的目标（`Namespace\\Class/method`）。
  - `path`（可选）：显式类文件路径（相对 `/app`），用于无需或尚未完全配置 PSR-4 的情况。

## 支持的方法

```php
Routes::get(string $url, string $controller, string $path = "");
Routes::post(string $url, string $controller, string $path = "");
Routes::put(string $url, string $controller, string $path = "");
Routes::delete(string $url, string $controller, string $path = "");
Routes::patch(string $url, string $controller, string $path = "");
Routes::options(string $url, string $controller, string $path = "");
Routes::any(string $url, string $controller, string $path = "");
```

`any` 将接受所有 HTTP 方法（常用于简单页面或调试）。

## 示例

### 1) 根路由与控制器

```
use PhotonixCore\\Routes;
Routes::get("/", "App\\Home\\Controller\\Index/index");
```

控制器示例：

```php
<?php
namespace App\Home\Controller;
use App\baseController;
class Index extends baseController
{
    public function index(): void
    {
        echo "Hello, Photonix";
    }
}
```

### 2) 参数化路由

```
Routes::get("/user/{id}", "App\\User\\Controller\\Profile/show");
```

当访问 `/user/42` 时，`show(array $params)` 将收到：

```php
$params === ["id" => "42"]
```

### 3) API 路由

```php
Routes::post("/api/login", "App\\Auth\\Controller\\Login/submit", "/auth/controller/Login.php");
Routes::get("/api/me", "App\\Auth\\Controller\\Profile/me", "/auth/controller/Profile.php");
```

## URL 与匹配

- 精确匹配：形如 `/about`、`/docs/router`。
- 参数化匹配：形如 `/post/{slug}`、`/order/{id}/item/{itemId}`；每个占位符匹配单段 `[^/]+`。
- 路径标准化：调度时会标准化尾部斜杠并移除查询串；中文路径参数会进行 URL 解码。

## 入口与重写

- Apache：站点根指向 `public/`，启用 `.htaccess`；示例已提供于仓库。
- Nginx：参考 `public/nginx.htaccess` 或根目录 `nginx.htaccess`，确保所有未命中静态文件的请求转发到 `public/index.php`。

## 常见问题

- 访问 404：
  - 检查路由是否在 `app/routes/app.php` 注册且与请求方法一致。
  - 确认入口未阻断（重写规则正确）与 `Routes::runRouter()` 已执行。
  - 若使用显式 `path`，确保文件存在且路径相对于 `/app` 无误。

- 控制器未找到或 500：
  - 校验命名空间是否与 PSR-4 映射一致（例如 `App\\` -> `app/`）。
  - 方法名与类名大小写一致，且方法 `public` 可访问。


